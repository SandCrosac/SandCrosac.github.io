{include header}
<script type="text/javascript">
	window.page_id = 1;
</script>
<div class="wrapper">
	{include header_menu}
	{include left_menu}
	<div class="main-container">
		<div class="padding-md">
			<h2 class="header-text">
				充值订单列表
			</h2>
			<div class="smart-widget">
				<div class="smart-widget-inner">
					<div class="smart-widget-body">
						<table class="table table-striped" style="table-layout:fixed; word-break:break-all; word-wrap:break-word;">
							<thead>
								<tr>
									<th>订单号</th>
									<th>用户名 [UID]</th>
									<th>充值金额</th>
									<th>获取金币</th>
									<th>获取积分</th>
									<th>流水号</th>
									<th>状态</th>
									<th>充值时间</th>
									<th>支付方式</th>
								</tr>
							</thead>
							<tbody id="tbody">
								{foreach $data as $v}
								<tr>
									<td>{$v.creat_time}</td>
									<td>{$v.user} [{$v.pay_id}]</td>
									<td>{$v.money} 元</td>
									<td>{$v['jinbi']} 金币</td>
									<td>{$v['jifen']} 积分</td>
									<td>{$v['pay_no']}</td>
									<td style="color:#000;background: {if $v['status'] == 0}#ceface;{else}#facece{/if}">{if $v['status'] ==
										0}充值成功{else}充值失败{/if}</td>
									<td>{php echo date('Y-m-d H:is',$v['creat_time'])}</td>
									<td>{if $v['type'] == 1}支付宝{elseif $v['type']==2}QQ钱包{elseif $v['type'] == 3}微信支付{/if}</td>
								</tr>
								{/foreach}
							</tbody>
						</table>
						<form class="form-horizontal no-margin form-border">
							<div style="margin-bottom: 10px;" class="form-group">
								<label class="col-md-2 control-label">条件</label>
								<div class="col-md-10">
									<div class="row">
										<div class="col-md-6">
											<input id="page-size" type="text" class="form-control" placeholder="每页显示条数 [必填]" value="10">
										</div>
										<div class="col-md-6">
											<input id="user-box" type="text" class="form-control" placeholder="用户名 [选填]">
										</div>
									</div>
								</div>
							</div>
						</form>
						<div class="form-group">
							<div class="input-group">
								<span class="input-group-btn">
									<button onclick="load_data(--window.page_id)" class="btn btn-default" type="button">上一页</button>
								</span>
								<input id="pageid_text" type="text" class="form-control" value="第 1 页" disabled="">
								<span class="input-group-btn">
									<button onclick="load_data(++window.page_id)" class="btn btn-default" type="button">下一页</button>
								</span>
								<span class="input-group-btn">
									<button onclick="load_data(1)" class="btn btn-default" type="button">刷新新条件</button>
								</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div><!-- ENd box  -->
</div>
<script type="text/javascript">
	function load_data(i) {
		if (i < 1) {
			window.page_id = 1;
			return;
		}
		$("#pageid_text").val('第 ' + i + ' 页');
		$.post(window.location.href, { page_id: i, page_size: $("#page-size").val(), user: $("#user-box").val() }, function (e) {
			if (!e.error) {
				$("#tbody").html('<tr><td>无数据</td></td>');
				return;
			}
			var html = '';
			for (o in e.data) {
				var val = '<td><a href="{#WWW}admin{#EXP}tixian?id=' + e.data[o].id + '" class="btn btn-xs btn-success">通过</a> <a href="{#WWW}admin{#EXP}tixian?cid=' + e.data[o].id + '" class="btn btn-xs btn-danger">撤回</a></td>';
				if (e.data[o].state == 1)
					val = '';
				html += '<tr><td>' + e.data[o].pid + '</td><td>' + e.data[o].user + ' [' + e.data[o].uid + ']</td><td >' + e.data[o].money + ' 元</td><td>' + (e.data[o].gold) + ' 金币</td><td style="color:#000;background: ' + (e.data[o].state == 1 ? '#ceface' : '#facece') + '">' + (e.data[o].state == 1 ? '充值成功' : '未付款') + '</td><td>' + e.data[o].time + '</td><td >' + e.data[o].type + '</td></tr>'
			}
			$("#tbody").html(html);
		}, 'json');
	}
</script>
{include footer}